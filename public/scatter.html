<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Gumi PCλ°© μ΄μ©λ£ Scatter</title>
  <link rel="stylesheet" href="./vendor/apexcharts/dist/apexcharts.css" />
  <script src="./vendor/apexcharts/dist/apexcharts.js"></script>
</head>
<body>
  <h2 style="text-align:center;">π“ κµ¬λ―Έ PCλ°© μ΄μ©λ£ Scatter μ°¨νΈ</h2>
  <div id="chart"></div>

  <script>
    // μ‹¤μ  JSON κµ¬μ΅° λ€μ‘
    //fetch(`https://apis.data.go.kr/5080000/pricesInfoService/getPricesInfo?serviceKey=85ce971033ed5ac42638fd66e56c14bd381d6ed61f40953b97bc60730aca620b&pageNo=1&numOfRows=100`) // λλ” API μ—”λ“ν¬μΈνΈ
    fetch(`http://localhost:3000/api/gumi`) // λλ” API μ—”λ“ν¬μΈνΈ
      .then(res => res.json())
      .then(json => {
        const data = json.body; // body λ°°μ—΄ μ¶”μ¶

        // Scatter λ°μ΄ν„° λ³€ν™
        const seriesData = data.map(item => ({
          x: item.se,   // ν–‰μ •κµ¬μ—­λ…
          y: item.pc    // κ°€κ²©
        }));

        const options = {
          chart: {
            type: "scatter",
            height: 350,
            zoom: { enabled: true, type: "xy" }
          },
          series: [{
            name: "PCλ°© μ΄μ©λ£",
            data: seriesData
          }],
          xaxis: {
            type: "category",
            title: { text: "ν–‰μ •κµ¬μ—­" }
          },
          yaxis: {
            title: { text: "μ΄μ©λ£ (μ›)" },
            min: 0
          },
          tooltip: {
            custom: function({ dataPointIndex }) {
              const item = data[dataPointIndex];
              return `
                <div style="padding:8px">
                  <b>${item.se}</b><br/>
                  ${item.prdlst_nm} : ${item.pc.toLocaleString()}μ›<br/>
                  κΈ°μ¤€μΌ: ${item.date_stdde}
                </div>
              `;
            }
          },
          colors: ["#3B82F6"]
        };

        const chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
      })
      .catch(err => {
        console.error("λ°μ΄ν„° λ΅λ“ μ‹¤ν¨:", err);
      });
  </script>
</body>
</html>
